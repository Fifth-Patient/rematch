(self.webpackChunkrematch_docs=self.webpackChunkrematch_docs||[]).push([[6777],{3245:function(e,t,n){"use strict";var r=n(7378);t.Z=function(e){var t=e.children,n=e.hidden,a=e.className;return r.createElement("div",{role:"tabpanel",hidden:n,className:a},t)}},8287:function(e,t,n){"use strict";n.d(t,{Z:function(){return m}});var r=n(7378),a=n(1415),o=n(8944),i="tabItem_c0e5",l="tabItemActive_28AG";var s=37,u=39;var m=function(e){var t=e.lazy,n=e.block,m=e.defaultValue,c=e.values,p=e.groupId,d=e.className,f=(0,a.Z)(),g=f.tabGroupChoices,h=f.setTabGroupChoices,b=(0,r.useState)(m),y=b[0],v=b[1],k=r.Children.toArray(e.children),w=[];if(null!=p){var x=g[p];null!=x&&x!==y&&c.some((function(e){return e.value===x}))&&v(x)}var N=function(e){var t=e.currentTarget,n=w.indexOf(t),r=c[n].value;v(r),null!=p&&(h(p,r),setTimeout((function(){var e,n,r,a,o,i,s,u;(e=t.getBoundingClientRect(),n=e.top,r=e.left,a=e.bottom,o=e.right,i=window,s=i.innerHeight,u=i.innerWidth,n>=0&&o<=u&&a<=s&&r>=0)||(t.scrollIntoView({block:"center",behavior:"smooth"}),t.classList.add(l),setTimeout((function(){return t.classList.remove(l)}),2e3))}),150))},O=function(e){var t,n;switch(e.keyCode){case u:var r=w.indexOf(e.target)+1;n=w[r]||w[0];break;case s:var a=w.indexOf(e.target)-1;n=w[a]||w[w.length-1]}null==(t=n)||t.focus()};return r.createElement("div",{className:"tabs-container"},r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.Z)("tabs",{"tabs--block":n},d)},c.map((function(e){var t=e.value,n=e.label;return r.createElement("li",{role:"tab",tabIndex:y===t?0:-1,"aria-selected":y===t,className:(0,o.Z)("tabs__item",i,{"tabs__item--active":y===t}),key:t,ref:function(e){return w.push(e)},onKeyDown:O,onFocus:N,onClick:N},n)}))),t?(0,r.cloneElement)(k.filter((function(e){return e.props.value===y}))[0],{className:"margin-vert--md"}):r.createElement("div",{className:"margin-vert--md"},k.map((function(e,t){return(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==y})}))))}},1335:function(e,t,n){"use strict";var r=(0,n(7378).createContext)(void 0);t.Z=r},1415:function(e,t,n){"use strict";var r=n(7378),a=n(1335);t.Z=function(){var e=(0,r.useContext)(a.Z);if(null==e)throw new Error("`useUserPreferencesContext` is used outside of `Layout` Component.");return e}},9121:function(e,t,n){"use strict";n.d(t,{Y:function(){return l}});var r=n(7378),a=n(8287),o=n(3245),i=[{label:"JavaScript",value:"js"},{label:"Typescript",value:"ts"}],l=function(e){var t=e.defaultValue,n=void 0===t?"js":t,l=e.values,s=void 0===l?i:l,u=e.children;return r.createElement(a.Z,{defaultValue:n,values:s},s.map((function(e,t){return r.createElement(o.Z,{key:e.value,value:e.value},u[t])})))}},7891:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return u},metadata:function(){return m},toc:function(){return c},default:function(){return d}});var r=n(9603),a=n(120),o=(n(7378),n(5318)),i=n(8287),l=n(3245),s=n(9121),u={id:"immer",title:"Immer",sidebar_label:"@rematch/immer",slug:"/plugins/immer/"},m={unversionedId:"plugins/immer",id:"plugins/immer",isDocsHomePage:!1,title:"Immer",description:"Immer plugin for Rematch. Wraps your reducers with immer, providing ability to safely do mutable changes resulting in immutable state.",source:"@site/../docs/plugins/immer.md",sourceDirName:"plugins",slug:"/plugins/immer/",permalink:"/docs/plugins/immer/",editUrl:"https://github.com/rematch/rematch/edit/main/docs/../docs/plugins/immer.md",version:"current",sidebar_label:"@rematch/immer",frontMatter:{id:"immer",title:"Immer",sidebar_label:"@rematch/immer",slug:"/plugins/immer/"},sidebar:"docs",previous:{title:"Introduction",permalink:"/docs/plugins/"},next:{title:"Select",permalink:"/docs/plugins/select/"}},c=[{value:"Compatibility",id:"compatibility",children:[]},{value:"Install",id:"install",children:[]},{value:"immerPlugin(config)",id:"immerpluginconfig",children:[]},{value:"Usage",id:"usage",children:[]}],p={toc:c};function d(e){var t=e.components,n=(0,a.Z)(e,["components"]);return(0,o.kt)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Immer plugin for Rematch. Wraps your reducers with immer, providing ability to safely do mutable changes resulting in immutable state."),(0,o.kt)("h2",{id:"compatibility"},"Compatibility"),(0,o.kt)("p",null,"Install the correct version of immer plugin based on the version of the core Rematch library in your project."),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:"center"},"@rematch/core"),(0,o.kt)("th",{parentName:"tr",align:"center"},"@rematch/immer"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},"1.x.x"),(0,o.kt)("td",{parentName:"tr",align:"center"},"1.x.x")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"center"},"2.x.x"),(0,o.kt)("td",{parentName:"tr",align:"center"},"2.x.x")))),(0,o.kt)("h2",{id:"install"},"Install"),(0,o.kt)(i.Z,{groupId:"npm2yarn",defaultValue:"npm",values:[{label:"npm",value:"npm"},{label:"Yarn",value:"yarn"}],mdxType:"Tabs"},(0,o.kt)(l.Z,{value:"npm",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"npm install @rematch/immer\n"))),(0,o.kt)(l.Z,{value:"yarn",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"yarn add @rematch/immer\n")))),(0,o.kt)("h2",{id:"immerpluginconfig"},"immerPlugin(","[config]",")"),(0,o.kt)("p",null,"Immer plugin accepts one optional argument - ",(0,o.kt)("strong",{parentName:"p"},"config"),", which is an object with the following properties:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"[",(0,o.kt)("inlineCode",{parentName:"li"},"whitelist"),"]"," (",(0,o.kt)("em",{parentName:"li"},"string[]"),"): an array of models' names. Allows defining on a model level, which reducers should be wrapped with immer."),(0,o.kt)("li",{parentName:"ul"},"[",(0,o.kt)("inlineCode",{parentName:"li"},"blacklist"),"]"," (",(0,o.kt)("em",{parentName:"li"},"string[]"),"): an array of models' names. Allows defining on a model level, which reducers should ",(0,o.kt)("strong",{parentName:"li"},"not")," be wrapped with immer.")),(0,o.kt)("p",null,"If config isn't provided, reducers from all models will be wrapped with immer."),(0,o.kt)("h2",{id:"usage"},"Usage"),(0,o.kt)("p",null,"In Immer, reducers can perform mutations to achieve the next immutable state. ",(0,o.kt)("strong",{parentName:"p"},"Immer doesn't require that you return the next state from a reducer, but @rematch/immer plugin expects you to do it!")," Your reducers must always return the next state. Otherwise, you will reset your model's state. See the example below for details."),(0,o.kt)("p",null,"If your state is a primitive value like a number of a string, plugin automatically avoids using immer to execute the reducer, because immer can only recognize changes to the plain objects or arrays."),(0,o.kt)(s.Y,{mdxType:"MultiLangComponent"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="store.js"',title:'"store.js"'},"import immerPlugin from '@rematch/immer'\nimport { init } from '@rematch/core'\nimport { models } from './models'\n\ninit({\n  models,\n    plugins: [immerPlugin()],\n})\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="store.ts"',title:'"store.ts"'},"import immerPlugin from '@rematch/immer'\nimport { init } from '@rematch/core'\nimport { models, RootModel } from './models'\n\nexport const store = init<RootModel>({\n  models,\n  // add immerPlugin to your store\n    plugins: [immerPlugin()],\n})\n\nexport type Store = typeof store\nexport type Dispatch = RematchDispatch<RootModel>\nexport type RootState = RematchRootState<RootModel>\n"))),(0,o.kt)(s.Y,{mdxType:"MultiLangComponent"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"export const todo = {\n    state: [\n        {\n            todo: 'Learn typescript',\n            done: true,\n        },\n        {\n            todo: 'Try immer',\n            done: false,\n        },\n    ],\n    reducers: {\n        done(state) {\n      // mutable changes to the state\n            state.push({ todo: 'Tweet about it' })\n            state[1].done = true\n            return state\n        },\n        // when 'reset' reducer is executed, the state will be set\n        // to 'undefined' because reducer doesn't return the next state\n        reset(state) {\n                state[0].done = false\n        },\n    },\n}\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"import { createModel } from '@rematch/core'\nimport { RootModel } from '.'\n\nexport const todo = createModel<RootModel>()({\n    state: [\n        {\n            todo: 'Learn typescript',\n            done: true,\n        },\n        {\n            todo: 'Try immer',\n            done: false,\n        },\n    ],\n    reducers: {\n        done(state) {\n      // mutable changes to the state\n            state.push({ todo: 'Tweet about it' })\n            state[1].done = true\n            return state\n        },\n        // when 'reset' reducer is executed, the state will be set\n        // to 'undefined' because reducer doesn't return the next state\n        reset(state) {\n                state[0].done = false\n        },\n    },\n})\n"))))}d.isMDXComponent=!0},5318:function(e,t,n){"use strict";n.d(t,{Zo:function(){return m},kt:function(){return d}});var r=n(7378);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),u=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},m=function(e){var t=u(e.components);return r.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},p=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),p=u(n),d=a,f=p["".concat(s,".").concat(d)]||p[d]||c[d]||o;return n?r.createElement(f,i(i({ref:t},m),{},{components:n})):r.createElement(f,i({ref:t},m))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=p;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var u=2;u<o;u++)i[u]=n[u];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}p.displayName="MDXCreateElement"},8944:function(e,t,n){"use strict";function r(e){var t,n,a="";if("string"==typeof e||"number"==typeof e)a+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=r(e[t]))&&(a&&(a+=" "),a+=n);else for(t in e)e[t]&&(a&&(a+=" "),a+=t);return a}function a(){for(var e,t,n=0,a="";n<arguments.length;)(e=arguments[n++])&&(t=r(e))&&(a&&(a+=" "),a+=t);return a}n.d(t,{Z:function(){return a}})}}]);