(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{108:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return c})),n.d(t,"metadata",(function(){return i})),n.d(t,"toc",(function(){return s})),n.d(t,"default",(function(){return p}));var a=n(3),o=n(7),r=(n(0),n(120)),c={id:"typescript",title:"Typescript",sidebar_label:"Typescript",slug:"/getting-started/typescript"},i={unversionedId:"typescript",id:"typescript",isDocsHomePage:!1,title:"Typescript",description:"Rematch handles Typescript inference practically out of the box, we have all our codebase with Typescript (latest version) and we do continuous testing to our typescript examples.",source:"@site/../docs/typescript.md",slug:"/getting-started/typescript",permalink:"/docs/getting-started/typescript",editUrl:"https://github.com/rematch/rematch/edit/main/docs/../docs/typescript.md",version:"current",sidebar_label:"Typescript",sidebar:"docs",previous:{title:"Installation",permalink:"/docs/getting-started/installation"},next:{title:"Rematch API Reference",permalink:"/docs/api-reference/"}},s=[{value:"createModel",id:"createmodel",children:[]},{value:"RootModel",id:"rootmodel",children:[]},{value:"init() store",id:"init-store",children:[{value:"init",id:"init",children:[]},{value:"init with plugins",id:"init-with-plugins",children:[]}]},{value:"React Hooks Types",id:"react-hooks-types",children:[]},{value:"React class types",id:"react-class-types",children:[]},{value:"Effects returning values",id:"effects-returning-values",children:[]}],l={toc:s};function p(e){var t=e.components,n=Object(o.a)(e,["components"]);return Object(r.b)("wrapper",Object(a.a)({},l,n,{components:t,mdxType:"MDXLayout"}),Object(r.b)("p",null,"Rematch handles Typescript inference practically out of the box, we have all our codebase with Typescript (latest version) and we do continuous testing to our ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/rematch/rematch/tree/main/examples/all-plugins-react-ts"}),"typescript examples"),"."),Object(r.b)("p",null,"For getting a cool Typescript setup with Rematch, it's as easy as using ",Object(r.b)("inlineCode",{parentName:"p"},"createModel")," helper."),Object(r.b)("h3",{id:"createmodel"},"createModel"),Object(r.b)("p",null,"Use helper method ",Object(r.b)("inlineCode",{parentName:"p"},"createModel")," to create a model."),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-tsx",metastring:'title="count.ts"',title:'"count.ts"'}),"import { createModel } from '@rematch/core'\nimport { RootModel } from './models'\n\nexport const count = createModel<RootModel>()({\n    state: 0,\n    reducers: {\n        increment(state, payload: number) {\n            return state + payload\n        },\n    },\n    effects: (dispatch) => ({\n        incrementAsync(payload: number, state) {\n            dispatch.count.increment(payload)\n        },\n    }),\n});\n")),Object(r.b)("p",null,"In the case of a complex state, like custom types just use ",Object(r.b)("inlineCode",{parentName:"p"},"as"),":"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-tsx"}),"import { createModel } from '@rematch/core'\nimport { RootModel } from './models'\n\ntype Names = 'custom'\ntype ComplexCount = {\n    count: number;\n    multiplierName: Names;\n}\n\nexport const count = createModel<RootModel>()({\n    state: {\n        count: 0,\n        multiplierName: 'custom'\n    } as ComplexCount, // <-\n    reducers: {\n        increment(state, payload: number) {\n            return {\n                count: state.count + payload\n            }\n        },\n    },\n    effects: (dispatch) => ({\n        incrementAsync(payload: number, state) {\n            dispatch.count.increment(payload)\n        },\n    }),\n});\n")),Object(r.b)("h3",{id:"rootmodel"},"RootModel"),Object(r.b)("p",null,"RootModel is the file that stores all your models. We need it because you can dispatch effects and access state from other models (it's global), so we need to know all the models for bringing you the intellisense."),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-tsx",metastring:'title="models.ts"',title:'"models.ts"'}),"import { Models } from '@rematch/core'\nimport { count } from './count'\n\nexport interface RootModel extends Models<RootModel> {\n    count: typeof count\n}\n\nexport const models: RootModel = { count }\n")),Object(r.b)("h2",{id:"init-store"},"init() store"),Object(r.b)("h3",{id:"init"},"init"),Object(r.b)("p",null,"With your model ready with ",Object(r.b)("inlineCode",{parentName:"p"},"createModel()")," helper and the ",Object(r.b)("inlineCode",{parentName:"p"},"RootModel")," exported, you only need to ",Object(r.b)("inlineCode",{parentName:"p"},"init()")," the store."),Object(r.b)("p",null,"Now we like to export some common types:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("strong",{parentName:"li"},"Store"),": type"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("strong",{parentName:"li"},"RematchDispatch"),": useful for knowing all the effects and reducers methods and his parameters"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("strong",{parentName:"li"},"RematchRootState"),": you will get intellisense of each state of each model.")),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ts",metastring:'title="store.ts"',title:'"store.ts"'}),"import { init, RematchDispatch, RematchRootState } from '@rematch/core'\nimport { models, RootModel } from './models'\n\nexport const store = init({\n    models,\n})\n\nexport type Store = typeof store\nexport type Dispatch = RematchDispatch<RootModel>\nexport type RootState = RematchRootState<RootModel>\n")),Object(r.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(r.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(r.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"}),Object(r.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})))),"tip")),Object(r.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(r.b)("p",{parentName:"div"},"In the case you use some plugin, please read this:"))),Object(r.b)("h3",{id:"init-with-plugins"},"init with plugins"),Object(r.b)("p",null,"Some plugins modifies the store like ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/plugins/loading"}),Object(r.b)("inlineCode",{parentName:"a"},"@rematch/loading")),", that introduces a new state with all your promises status, Typescript to know that needs some helper."),Object(r.b)("p",null,"You need to pass the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"#RootModel"}),Object(r.b)("inlineCode",{parentName:"a"},"RootModel"))," to ",Object(r.b)("inlineCode",{parentName:"p"},"init()")," function and introduce the helpers:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("strong",{parentName:"li"},"@rematch/loading"),":  { ExtraModelsFromLoading }"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("strong",{parentName:"li"},"@rematch/updated"),":  { ExtraModelsFromUpdated }")),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ts",metastring:'title="store.ts"',title:'"store.ts"'}),"import { init, RematchDispatch, RematchRootState } from '@rematch/core'\nimport { models, RootModel } from './models'\n\n/** Plugins **/\nimport updatedPlugin, { ExtraModelsFromUpdated } from '@rematch/updated'\nimport loadingPlugin, { ExtraModelsFromLoading } from '@rematch/loading'\n\ntype FullModel =  ExtraModelsFromLoading<RootModel> & ExtraModelsFromUpdated<RootModel>\n\nexport const store = init<RootModel, FullModel>({\n    models,\n    plugins: [\n        loadingPlugin(),\n        updatedPlugin(),\n    ]\n})\n\nexport type Store = typeof store\nexport type Dispatch = RematchDispatch<RootModel>\nexport type RootState = RematchRootState<RootModel>\n")),Object(r.b)("h2",{id:"react-hooks-types"},"React Hooks Types"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("strong",{parentName:"li"},"RootState")," and ",Object(r.b)("strong",{parentName:"li"},"Dispatch")," types: import this types from the previous file mentioned: ",Object(r.b)("a",Object(a.a)({parentName:"li"},{href:"#init"}),"init"))),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-tsx"}),"import React from 'react'\nimport { RootState, Dispatch } from './store'\nimport { useDispatch, useSelector } from 'react-redux'\n\nconst Count = () => {\n    const countState = useSelector((state: RootState) => state.count)\n    const dispatch = useDispatch<Dispatch>()\n\n    return (\n        <div>example</div>\n    )\n}\n")),Object(r.b)("h2",{id:"react-class-types"},"React class types"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-tsx"}),"import React from 'react'\nimport { RootState, Dispatch } from './store'\nimport { connect } from 'react-redux'\n\nclass App extends React.PureComponent<Props> {\n    render() {\n        const { countState } = this.props\n        return (\n            <div>example</div>\n        )\n    }\n}\n\nconst mapState = (state: RootState) => ({\n    countState: state.count,\n})\n\nconst mapDispatch = (dispatch: Dispatch) => ({\n    count: dispatch.count,\n})\n\ntype StateProps = ReturnType<typeof mapState>\ntype DispatchProps = ReturnType<typeof mapDispatch>\ntype Props = StateProps & DispatchProps\n\nexport default connect(mapState, mapDispatch)(App)\n")),Object(r.b)("h2",{id:"effects-returning-values"},"Effects returning values"),Object(r.b)("p",null,"There's a situation where if you're accessing the ",Object(r.b)("inlineCode",{parentName:"p"},"rootState")," value of the same model and returning this value. Typescript will fail because circular references itself (has sense)..."),Object(r.b)("p",null,"You should try to avoid returning values on effects and just dispatch data to reducers or write pure functions outside Rematch for a better performance."),Object(r.b)("p",null,"Anyways, you can omit this error force typing the effect. ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/rematch/rematch/issues/864#issuecomment-781357794"}),"Related Github Issue")),Object(r.b)("p",null,"Instead of:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ts"}),"async isIdEnabled(payload: { name: string }, rootState) {\n   // ...\n}\n")),Object(r.b)("p",null,"Define the return value:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ts"}),"async isIdEnabled(payload: { name: string }, rootState): Promise<boolean> {\n  // ...\n}\n")))}p.isMDXComponent=!0},120:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return b}));var a=n(0),o=n.n(a);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=o.a.createContext({}),p=function(e){var t=o.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=p(e.components);return o.a.createElement(l.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},u=o.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,c=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),d=p(n),u=a,b=d["".concat(c,".").concat(u)]||d[u]||m[u]||r;return n?o.a.createElement(b,i(i({ref:t},l),{},{components:n})):o.a.createElement(b,i({ref:t},l))}));function b(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,c=new Array(r);c[0]=u;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:a,c[1]=i;for(var l=2;l<r;l++)c[l]=n[l];return o.a.createElement.apply(null,c)}return o.a.createElement.apply(null,n)}u.displayName="MDXCreateElement"}}]);